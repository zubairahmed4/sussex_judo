# This file was generated by the Tkinter Designer by Parth Jadhav
# https://github.com/ParthJadhav/Tkinter-Designer

# from tkinter import *
# Explicit imports to satisfy Flake8

import subprocess
from pathlib import Path
from tkinter import Tk, Canvas, Entry, Button, PhotoImage


def relative_to_assets(path: str) -> Path:
    OUTPUT_PATH = Path(__file__).parent
    ASSETS_PATH = OUTPUT_PATH / Path(r"./assets/results_page")
    return ASSETS_PATH / Path(path)


class ResultsPage:
    def __init__(self, name, weight, comp_entered, comp_weight, coaching_hours, training_plan):
        # Initialize attributes with passed data
        self.name = name
        self.weight = weight
        self.comp_entered = comp_entered
        self.comp_weight = comp_weight
        self.coaching_hours = coaching_hours
        self.training_plan = training_plan

        # Settings
        self.default_font = ('Poppins', 12, "bold")
        self.colour = "white"

        self.messagebox = None
        # Create Window
        self.window = Tk()
        self.window.title("Results Page - North Sussex Judo")
        self.window.iconbitmap("./assets/icon.ico")
        self.window.geometry("500x500")
        self.window.configure(bg="#FFFFFF")

        self.canvas = Canvas(
            self.window,
            bg="#FFFFFF",
            height=500,
            width=500,
            bd=0,
            highlightthickness=0,
            relief="ridge"
        )
        self.canvas.place(x=0, y=0)

        # Background
        self.image_image_1 = PhotoImage(file=relative_to_assets("image_1.png"))
        self.image_1 = self.canvas.create_image(250.0, 250.0, image=self.image_image_1)

        # Results Title
        self.image_image_2 = PhotoImage(file=relative_to_assets("image_2.png"))
        self.image_2 = self.canvas.create_image(247.0, 40.0, image=self.image_image_2)

        # Name Title
        self.image_image_3 = PhotoImage(file=relative_to_assets("image_3.png"))
        self.image_3 = self.canvas.create_image(192.0, 84.0, image=self.image_image_3)

        # Name Entry
        self.entry_image_8 = PhotoImage(file=relative_to_assets("entry_8.png"))
        self.entry_bg_8 = self.canvas.create_image(286.0, 85.0, image=self.entry_image_8)
        self.entry_8 = Entry(
            bd=0,
            bg="#003499",
            fg=self.colour,
            font=self.default_font,
            highlightthickness=0
        )
        self.entry_8.place(
            x=228.68488836288452,
            y=70.0,
            width=114.63022327423096,
            height=28.0
        )

        # £Cost Title
        self.image_image_4 = PhotoImage(file=relative_to_assets("image_4.png"))
        self.image_4 = self.canvas.create_image(364.0, 136.0, image=self.image_image_4)

        # Activity Title
        self.image_image_5 = PhotoImage(file=relative_to_assets("image_5.png"))
        self.image_5 = self.canvas.create_image(142.0, 134.0, image=self.image_image_5)

        # Training Plan Title
        self.image_image_6 = PhotoImage(file=relative_to_assets("image_6.png"))
        self.image_6 = self.canvas.create_image(151.0, 171.0, image=self.image_image_6)

        # Training Plan Entry
        self.entry_image_2 = PhotoImage(file=relative_to_assets("entry_2.png"))
        self.entry_bg_2 = self.canvas.create_image(362.0, 170.5, image=self.entry_image_2)
        self.entry_2 = Entry(
            bd=0,
            bg="#0056FF",
            fg=self.colour,
            font=self.default_font,
            highlightthickness=0
        )
        self.entry_2.place(
            x=304.6848883628845,
            y=158.0,
            width=114.63022327423096,
            height=23.0
        )

        # Private Coaching Title
        self.image_image_7 = PhotoImage(file=relative_to_assets("image_7.png"))
        self.image_7 = self.canvas.create_image(151.0, 233.0, image=self.image_image_7)

        # Private Coaching Cost
        self.entry_image_3 = PhotoImage(file=relative_to_assets("entry_3.png"))
        self.entry_bg_3 = self.canvas.create_image(362.0, 232.5, image=self.entry_image_3)
        self.entry_3 = Entry(
            bd=0,
            bg="#0056FF",
            fg=self.colour,
            font=self.default_font,
            highlightthickness=0
        )
        self.entry_3.place(
            x=304.6848883628845,
            y=220.0,
            width=114.63022327423096,
            height=23.0
        )

        # Current Weight Title
        self.image_image_8 = PhotoImage(file=relative_to_assets("image_8.png"))
        self.image_8 = self.canvas.create_image(147.0, 321.0, image=self.image_image_8)

        # Current Weight Entry
        self.entry_image_4 = PhotoImage(file=relative_to_assets("entry_4.png"))
        self.entry_bg_4 = self.canvas.create_image(361.0, 320.5, image=self.entry_image_4)
        self.entry_4 = Entry(
            bd=0,
            bg="#0056FF",
            fg=self.colour,
            font=self.default_font,
            highlightthickness=0
        )
        self.entry_4.place(
            x=303.6848883628845,
            y=308.0,
            width=114.63022327423096,
            height=23.0
        )

        # Weight Comparison Title
        self.image_image_9 = PhotoImage(file=relative_to_assets("image_9.png"))
        self.image_9 = self.canvas.create_image(147.0, 390.0, image=self.image_image_9)

        # Weight Comparison Entry
        self.entry_image_5 = PhotoImage(file=relative_to_assets("entry_5.png"))
        self.entry_bg_5 = self.canvas.create_image(362.0, 391.5, image=self.entry_image_5)
        self.entry_5 = Entry(
            bd=0,
            bg="#0056FF",
            fg=self.colour,
            font=self.default_font,
            highlightthickness=0
        )
        self.entry_5.place(
            x=304.6848883628845,
            y=379.0,
            width=114.63022327423096,
            height=23.0
        )

        # Competition Title
        self.image_image_10 = PhotoImage(file=relative_to_assets("image_10.png"))
        self.image_10 = self.canvas.create_image(151.0, 202.0, image=self.image_image_10)

        # Competition Entry
        self.entry_image_1 = PhotoImage(file=relative_to_assets("entry_1.png"))
        self.entry_bg_1 = self.canvas.create_image(362.0, 200.5, image=self.entry_image_1)
        self.entry_1 = Entry(
            bd=0,
            bg="#003499",
            fg=self.colour,
            font=self.default_font,
            highlightthickness=0
        )
        self.entry_1.place(
            x=304.6848883628845,
            y=188.0,
            width=114.63022327423096,
            height=23.0
        )

        # Total Cost Title
        self.image_image_11 = PhotoImage(file=relative_to_assets("image_11.png"))
        self.image_11 = self.canvas.create_image(151.0, 264.0, image=self.image_image_11)

        # Total Cost Entry
        self.entry_image_6 = PhotoImage(file=relative_to_assets("entry_6.png"))
        self.entry_bg_6 = self.canvas.create_image(362.0, 262.5, image=self.entry_image_6)
        self.entry_6 = Entry(
            bd=0,
            bg="#003499",
            fg=self.colour,
            font=self.default_font,
            highlightthickness=0
        )
        self.entry_6.place(
            x=304.6848883628845,
            y=250.0,
            width=114.63022327423096,
            height=23.0
        )

        # Competition Weight Title
        self.image_image_12 = PhotoImage(file=relative_to_assets("image_12.png"))
        self.image_12 = self.canvas.create_image(146.0, 358.0, image=self.image_image_12)

        # Competition Weight Entry
        self.entry_image_7 = PhotoImage(file=relative_to_assets("entry_7.png"))
        self.entry_bg_7 = self.canvas.create_image(361.0, 356.5, image=self.entry_image_7)
        self.entry_7 = Entry(
            bd=0,
            bg="#003499",
            fg=self.colour,
            font=self.default_font,
            highlightthickness=0
        )
        self.entry_7.place(
            x=303.6848883628845,
            y=344.0,
            width=114.63022327423096,
            height=23.0
        )

        # Line Image
        self.image_image_13 = PhotoImage(file=relative_to_assets("image_13.png"))
        self.image_13 = self.canvas.create_image(253.0, 201.0, image=self.image_image_13)

        def back_button_clicked():
            self.window.destroy()
            subprocess.run(["python", "calc_page.py"])

        # Back Button Image
        self.button_image_1 = PhotoImage(file=relative_to_assets("button_1.png"))
        self.button_1 = Button(
            image=self.button_image_1,
            borderwidth=0,
            highlightthickness=0,
            command=back_button_clicked,
            relief="flat"
        )
        self.button_1.place(
            x=170.0,
            y=433.0,
            width=160.0,
            height=40.0
        )

        # Call process_results to populate fields with passed data
        self.process_results(name, weight, comp_entered, comp_weight, coaching_hours, training_plan)

        self.window.resizable(False, False)
        self.window.mainloop()

    def process_results(self, name, weight, comp_entered, comp_weight, coaching_hours, training_plan):
        # Clear the entry fields before updating them with new values
        self.entry_1.delete(0, 'end')
        self.entry_2.delete(0, 'end')
        self.entry_3.delete(0, 'end')
        self.entry_4.delete(0, 'end')
        self.entry_5.delete(0, 'end')
        self.entry_6.delete(0, 'end')
        self.entry_7.delete(0, 'end')
        self.entry_8.delete(0, 'end')

        if training_plan in ["Beginner", "B", "b"]:
            training_cost = 100.0
            training_plan = "B"
        elif training_plan in ["Intermediate", "I", "i"]:
            training_cost = 120.0
            training_plan = "I"
        else:
            training_cost = 140.0
            training_plan = "E"

        weight_comparison = weight - comp_weight
        total_comp = 0
        # Competition
        competition_entry = self.entry_1
        if comp_entered == 0 or training_plan == "B":
            competition_entry.insert(0, 'None')
        else:
            total_comp = comp_entered * 22.0
            competition_entry.insert(0, '£' + str(total_comp))
        total_coached = coaching_hours * 9.50
        total_cost = training_cost + total_comp + total_coached

        # Name
        name_entry = self.entry_8
        name_entry.insert(0, name + " (" + training_plan + ")")

        # Training Plan
        training_plan_entry = self.entry_2
        training_plan_entry.insert(0, '£' + str(training_cost))

        # Private Coaching
        coaching_hours_entry = self.entry_3
        coaching_hours_entry.insert(0, '£' + str(total_coached))

        # Total Cost
        total_cost_entry = self.entry_6
        total_cost_entry.insert(0, '£' + str(total_cost))

        # Current Weight
        weighting_entry = self.entry_4
        weighting_entry.insert(0, str(weight) + " kg")
        # Competition Weight
        comp_weight_entry = self.entry_7
        comp_weight_entry.insert(0, str(comp_weight) + " kg")
        # Weight Comparison
        weight_comparison_entry = self.entry_5
        weight_comparison_entry.insert(0, str(weight_comparison) + " kg")

        self.window.update_idletasks()
        self.window.update()
